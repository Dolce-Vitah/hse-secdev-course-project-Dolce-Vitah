|  Поток  | Угроза (STRIDE)                | Описание                                                 | Контроль / Мера                                 | Связанный NFR | Проверка / Артефакт                                    |
| :-----: | :----------------------------- | :------------------------------------------------------- | :---------------------------------------------- |:-------------:| :----------------------------------------------------- |
|  **F1** | **Spoofing (S)**               | Подделка логина при авторизации                          | JWT с TTL и проверкой подписи                   |    NFR-01     | `pytest test_auth_login_success`                       |
|  **F1** | **Denial of Service (D)**      | Массовые запросы на логин/регистрацию                    | Rate limiting, задержка на неуспешные логины    |    NFR-07     | нагрузочные тесты / redis limiter                      |
|  **F2** | **Tampering (T)**              | Изменение пароля без валидации                           | Хеширование Argon2id, проверка сложности пароля |    NFR-02     | `unit test_password_hash_and_verify`                   |
|  **F3** | **Information Disclosure (I)** | Утечка данных при SQL-запросе                            | ORM и Pydantic валидация                        |    NFR-09     | Bandit / SQLi тест                                     |
|  **F3** | **Elevation of Privilege (E)** | Получение данных другого пользователя через SQL-инъекцию | Ограничение выборки по `owner_id`, RBAC         |    NFR-03     | `pytest test_get_wish_forbidden`                       |
|  **F4** | **Tampering (T)**              | Подмена данных внутри токена JWT                         | Подпись токена HMAC и проверка на сервере       |    NFR-01     | `pytest test_create_access_token_contains_sub_and_exp` |
|  **F5** | **Repudiation (R)**            | Отсутствие журналирования CRUD                           | Логирование действий                            |    NFR-08     | Проверка логов в тестовой среде                        |
|  **F6** | **Elevation of Privilege (E)** | Доступ к чужим wishes                                    | Проверка `owner_id`, роль admin                 |    NFR-03     | `e2e test_get_wish_forbidden`                          |
|  **F6** | **Spoofing (S)**               | Использование чужого токена                              | Проверка подписи и срока действия JWT           |    NFR-01     | `pytest test_get_current_user_valid_token`             |
|  **F7** | **Tampering (T)**              | Подмена данных в PATCH                                   | JWT-аутентификация, schema валидация            |    NFR-09     | `pytest test_update_wish_invalid_data`                 |
|  **F8** | **Denial of Service (D)**      | Брутфорс логинов / Logout Flood                          | Rate limit и блокировка по IP                   |    NFR-07     | Нагрузочные тесты / redis limiter                      |
|  **F9** | **Repudiation (R)**            | Удаление токенов без логов                               | Логирование ревокации                           |    NFR-08     | Лог `revoke_token`                                     |
| **F10** | **Information Disclosure (I)** | Необезличенные логи                                      | Маскирование данных в логах                     |    NFR-08     | Ручная верификация формата логов                       |
